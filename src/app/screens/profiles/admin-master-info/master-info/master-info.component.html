<div class="dialog__title">
    <h2 mat-dialog-title> {{ data?.title }}</h2>
</div>
<mat-dialog-content>
    <form [formGroup]="form" novalidate autocomplete="off">
        <div fxLayout="row">

            <div class="item" *ngIf="data?.url === 'security-responsabilities'" fxFlex="75">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Nombre</mat-label>
                    <input matInput type="text" formControlName="name" placeholder="Nombre">
                    <app-validator [form]="form" name="name"></app-validator>
                </mat-form-field>
            </div>
            <div *ngIf="data?.url !== 'security-responsabilities'" class="item" fxFlex="25">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Nombre</mat-label>
                    <input matInput type="text" formControlName="name" placeholder="Nombre">
                    <app-validator [form]="form" name="name"></app-validator>
                </mat-form-field>
            </div>
            <div *ngIf="data?.url !== 'security-responsabilities'" class="item" fxFlex="50">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Descripción</mat-label>
                    <input matInput formControlName="description" placeholder="Descripción">
                    <app-validator [form]="form" name="description"></app-validator>
                </mat-form-field>
            </div>
            <div *ngIf="data?.url === 'types'" class="item" fxFlex="25">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Maestro</mat-label>
                    <mat-select formControlName="masterReference">
                        <mat-option *ngFor="let master of masters" [value]="master.name">
                            {{master.name }}
                        </mat-option>
                    </mat-select>
                    <app-validator [form]="form" name="masterReference" [otherIcon]="true"></app-validator>
                </mat-form-field>
            </div>
            <div *ngIf="data?.url !== 'types'" class="item" fxFlex="25">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Tipo</mat-label>
                    <mat-select #ej formControlName="type" (selectionChange)="typeValidation($event)">
                        <mat-option *ngFor="let type of types" [value]="type.name">
                            {{type.name}}
                        </mat-option>
                        <mat-option *ngIf="types?.length === 0" disabled>
                            <i>No hay tipos disponibles</i>
                        </mat-option>
                    </mat-select>
                    <app-validator [form]="form" name="type" [otherIcon]="true"></app-validator>
                </mat-form-field>
            </div>
        </div>
        <div fxLayout="row">
            <div class="item" fxFlex="25">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Habilidades Actuales</mat-label>
                    <mat-select #currentHabilities [ngClass]="{disabled:form.get('idParent')?.disabled}" formControlName="idParent">
                        <mat-option *ngFor="let skill of skills" [value]="skill._id">
                            {{form.value.type !== 'Habilidad' ? skill.name : null}}
                        </mat-option>
                        <mat-option *ngIf="skills?.length === 0" disabled [value]="false">
                            <i>No hay habilidades disponibles</i>
                        </mat-option>
                    </mat-select>
                    <app-validator [form]="form" name="idParent" [otherIcon]="true"></app-validator>
                </mat-form-field>
            </div>
            <div class="item" fxFlex="20">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Fecha de creación</mat-label>
                    <input matInput type="date" formControlName="createdAt" matTooltip="Fecha de creación del registro" placeholder="Fecha de creación" readonly>
                </mat-form-field>
            </div>
            <div class="item" fxFlex="20">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Fecha de modificación</mat-label>
                    <input matInput type="date" formControlName="updatedAt" matTooltip="Fecha de modificación del registro" placeholder="Fecha de modificación" readonly>
                </mat-form-field>
            </div>

            <div class="item" fxFlex="17">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Estado</mat-label>
                    <mat-button-toggle-group #statusToggleButton matTooltip="Indica si el registro esta activo o inactivo" formControlName="status" (change)="changeStatusOption($event)">
                        <mat-button-toggle [value]="true">
                            Activo
                        </mat-button-toggle>
                        <mat-button-toggle [value]="false">
                            Inactivo
                        </mat-button-toggle>
                    </mat-button-toggle-group>
                    <input matInput hidden>
                </mat-form-field>
            </div>
            &nbsp;
            <div class="item" fxFlex="10">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Subgrupo</mat-label>
                    <mat-button-toggle-group matTooltip="Indica si la habilidad tiene submenú / subcategoria " formControlName="submenu" (change)="changeSubgroupOption($event)">
                        <mat-button-toggle [value]="true">
                            Sí
                        </mat-button-toggle>
                        <mat-button-toggle [value]="false">
                            No
                        </mat-button-toggle>
                    </mat-button-toggle-group>
                    <input matInput hidden>
                </mat-form-field>
            </div>
        </div>
        <div *ngIf="manage_images.includes(data?.url)" fxLayout="row">
            <div class="item" fxFlex="50">
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">URL</mat-label>
                    <input matInput type="text" matTooltip="Indica a donde se quiere redirigir dentro de la app Mundo SETI" formControlName="url" placeholder="Url del módulo">
                    <app-validator [form]="form" name="url"></app-validator>
                </mat-form-field>
            </div>
            <div class="item file__container" fxFlex="49">
                <button class="file__button" (click)="fileInput.click()">
          <mat-icon class="file__icon">attach_file</mat-icon>
          <input #fileInput type="file" (change)="onFileChange($event)" style="display:none;" />
        </button>
                <mat-form-field floatLabel="always" appearance="none">
                    <mat-label class="label">Imagen</mat-label>
                    <input class="file__input" matInput type="text" matTooltip="Imagen para mostrar en el menú" formControlName="imagePath" readonly>
                </mat-form-field>
            </div>
        </div>

    </form>
    <div class="dialog__options">
        <button mat-button class="button button--accept" (click)="onSubmit()">Guardar</button>
        <button mat-button class="button button--cancel" [mat-dialog-close]="true">Cancelar</button>
    </div>

</mat-dialog-content>